# í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ (ê¶Œì¥)
# ê³µê²©ì  + ë³´ìˆ˜ì  + ë¶€ë¶„ì²­ì‚°ì˜ ì¥ì  ê²°í•©

trailing:
  activation_pct: 1.5        # ë¬¸ì„œ ëª…ì„¸: íŠ¸ë ˆì¼ë§ í™œì„±í™” +1.5%
  ratio: 1.0                 # ë¬¸ì„œ ëª…ì„¸: íŠ¸ë ˆì¼ë§ ë¹„ìœ¨ -1.0%
  stop_loss_pct: 3.0         # ë¬¸ì„œ ëª…ì„¸: ê¸°ë³¸ ì†ì ˆ -3.0%

  use_profit_tier: true      # í° ìˆ˜ìµ ì‹œ ê°•í™” âœ…
  profit_tier_threshold: 6.0 # ğŸ”§ FIX: +6% ë„ë‹¬ ì‹œ (ë¬¸ì„œ ëª…ì„¸ ë°˜ì˜)
  profit_tier_ratio: 0.5     # 0.5%ë¡œ ê°•í™”

  use_atr_based: true        # ğŸ”§ FIX: ATR ê¸°ë°˜ íŠ¸ë ˆì¼ë§ í™œì„±í™” (ë¬¸ì„œ ëª…ì„¸)
  atr_multiplier: 1.3        # âœ… ChatGPT ë¦¬ë·°: ATRÃ—1.3 (1.5â†’1.3, ì½”ìŠ¤ë‹¥ ë³€ë™ì„± ê³ ë ¤)

  # ğŸ”§ NEW: ë‹¹ì¼ ë§¤ìˆ˜ ì¢…ëª© ê°•í™” ì†ì ˆ (2026-01-20 ì œì´ì—”ë¹„ ë¶„ì„ ë°˜ì˜)
  # ë‹¹ì¼ ë§¤ìˆ˜ ì¢…ëª©ì€ ë” íƒ€ì´íŠ¸í•œ ì†ì ˆ ì ìš© (ì¥ê¸° í•˜ë½ ë…¸ì¶œ ë°©ì§€)
  same_day_entry:
    enabled: true              # ë‹¹ì¼ ë§¤ìˆ˜ ì¢…ëª© ê°•í™” ì†ì ˆ í™œì„±í™”
    stop_loss_pct: 1.5         # ë‹¹ì¼ ë§¤ìˆ˜: -1.5% ì†ì ˆ (ê¸°ë³¸ 3.0% â†’ 1.5%)
    trailing_ratio: 0.8        # ë‹¹ì¼ ë§¤ìˆ˜: íŠ¸ë ˆì¼ë§ 0.8% (ê¸°ë³¸ 1.0% â†’ 0.8%)

filters:
  use_trend_filter: true
  trend_period: 20

  # ğŸ“Š ML ê°œì„  (2025-12-15): L1 ê±°ë˜ëŸ‰ í•„í„° ê°•í™”
  # ì´ë²ˆì£¼ ë¶„ì„: ì¡°ê¸° ì†ì ˆ 5ê±´ ë¹ˆë°œ â†’ ì§„ì… í’ˆì§ˆ ê°œì„  í•„ìš”
  use_volume_filter: true
  volume_multiplier: 1.5     # 1.2 â†’ 1.5 (ê±°ë˜ëŸ‰ ê¸°ì¤€ ìƒí–¥)

  use_breakout_confirm: false
  breakout_confirm_candles: 2

  use_volume_value_filter: false
  min_volume_value: 1000000000

  use_market_momentum: false

  use_daily_trend_filter: true

  # ğŸ“Š ML ê°œì„  (2025-12-15): L2 ë³€ë™ì„± í•„í„° ê°•í™”
  # ì´ë²ˆì£¼ ë¶„ì„: ì¡°ê¸° ì†ì ˆ 5ê±´ ë¹ˆë°œ â†’ ë³€ë™ì„± ê¸°ì¤€ ê°•í™”
  use_volatility_filter: true   # ìœ„í—˜ ì¢…ëª© ì œì™¸ âœ…
  min_atr_pct: 0.8             # 0.5 â†’ 0.8 (ë„ˆë¬´ ë‚®ì€ ë³€ë™ì„± ì œì™¸)
  max_atr_pct: 4.0             # 4.5 â†’ 4.0 (ë„ˆë¬´ ìœ„í—˜í•œ ì¢…ëª© ì œì™¸)

time_filter:
  use_time_filter: true        # ğŸ”§ FIX: ì¥ ì´ˆë°˜/ë§ˆê° íšŒí”¼ í™œì„±í™” (ë¬¸ì„œ ëª…ì„¸)
  market_open: "09:00"
  market_close: "15:20"
  avoid_early_minutes: 30      # ğŸ”§ FIX: 09:30ê¹Œì§€ íšŒí”¼ (ë¬¸ì„œ ëª…ì„¸) [ë³µì›: 10â†’30]
  avoid_late_minutes: 21       # ğŸ”§ FIX: 14:59ê¹Œì§€ë§Œ ì§„ì… (15:20-21=14:59) [ë³µì›: 10â†’21]

  # ğŸ“Š ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ë°˜ì˜ (2026-01-17): ì˜¤ì „ì¥ì´ ê°€ì¥ íš¨ê³¼ì 
  # 8ì¼ ì‹œë®¬ë ˆì´ì…˜: ìŠ¹ë¥  50.7%, ì´ ìˆ˜ìµ +19,840ì›
  time_weight:
    morning_bonus: 1.5         # 09:30~12:00 ì‹ í˜¸ ê°€ì¤‘ì¹˜ 50% ì¦ê°€ (ì‹œë®¬ë ˆì´ì…˜ ìµœì  êµ¬ê°„)
    # ğŸ“Š ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼: ì˜¤í›„ì¥ ì§„ì… ì‹œ ì†ì‹¤ ì¦ê°€ â†’ squeeze_2tfëŠ” 12ì‹œ ì´ì „ë§Œ
    midday_penalty: 0.0        # 12:00~14:00 ì‹ í˜¸ ì™„ì „ ì°¨ë‹¨
    afternoon_penalty: 0.0     # 14:00~14:59 ì‹ í˜¸ ì™„ì „ ì°¨ë‹¨ (squeeze_2tf ê¸°ì¤€)

re_entry:
  use_cooldown: true           # ì¬ì§„ì… ë°©ì§€ âœ…
  cooldown_minutes: 20         # ì ì ˆí•œ ëŒ€ê¸° ì‹œê°„ (fallback)

  # ğŸ”§ 2026-02-07: ì¿¨ë‹¤ìš´ ì°¨ë“±í™” v2 (exit_reason ê¸°ë°˜)
  # Early Failure/ì†ì ˆ â†’ ê°•í•œ ì¿¨ë‹¤ìš´, ìµì ˆ â†’ ì¿¨ë‹¤ìš´ ì—†ìŒ
  reentry_cooldown:
    enabled: true
    by_exit_reason:
      # ğŸ”§ 2026-02-08: EF subtypeë³„ ì°¨ë“± ì¿¨ë‹¤ìš´
      ef_no_follow: 20           # êµ¬ì¡° ì‚´ì•„ìˆìŒ, íƒ€ì´ë°ë§Œ ì‹¤íŒ¨ â†’ ì§§ì€ ëŒ€ê¸°
      ef_no_demand: 45           # ìˆ˜ê¸‰ ë¶€ì¬, ê°€ì§œ ì‹ í˜¸ â†’ ê¸´ ëŒ€ê¸°
      early_failure: 60          # ë¯¸ë¶„ë¥˜ EF fallback â†’ ê°€ì¥ ìœ„í—˜, 60ë¶„
      stop_loss: 45              # ëª…í™•í•œ ì†ì ˆ â†’ 45ë¶„
      trailing_stop: 30          # íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ â†’ 30ë¶„
      time_exit: 20              # ì‹œê°„ ê¸°ë°˜ ì²­ì‚° â†’ ì§§ê²Œ 20ë¶„
      take_profit: 0             # ìµì ˆ â†’ ì°¨ë‹¨í•˜ì§€ ì•ŠìŒ
      partial_exit: 10           # ë¶€ë¶„ ì²­ì‚° â†’ ì§§ê²Œ 10ë¶„
      default: 30                # ë¶„ë¥˜ ë¶ˆê°€ â†’ ì•ˆì „ fallback 30ë¶„

    # ğŸ”§ 2026-02-07: ì¿¨ë‹¤ìš´ Override (ê°•í•œ ì‹ í˜¸ê°€ ì¿¨ë‹¤ìš´ bypass)
    override_rules:
      enabled: true
      blocked_reasons:             # ì´ ì¹´í…Œê³ ë¦¬ëŠ” ì ˆëŒ€ override ë¶ˆê°€
        - early_failure            # ë¯¸ë¶„ë¥˜ EF
        - ef_no_demand             # ìˆ˜ê¸‰ ë¶€ì¬ â†’ ì ˆëŒ€ ë¶ˆê°€
        # ef_no_followëŠ” override í—ˆìš© (êµ¬ì¡° ì‚´ì•„ìˆìœ¼ë¯€ë¡œ)
      squeeze_override:
        enabled: true
        bb_width_percentile_max: 15   # BB width percentile â‰¤ 15 (ê·¹ì‹¬í•œ ìˆ˜ì¶•)
        volume_mult_min: 2.5          # ê±°ë˜ëŸ‰ â‰¥ 20ì¼ í‰ê· ì˜ 2.5ë°°
        require_squeeze_on: true      # Squeeze ON ìƒíƒœ í•„ìˆ˜
      momentum_override:
        enabled: true
        roc3_min_pct: 2.5             # ROC(3) â‰¥ 2.5% (ê°•í•œ ë‹¨ê¸° ëª¨ë©˜í…€)
        rsi14_min: 65                 # RSI(14) â‰¥ 65 (ìƒìŠ¹ ëª¨ë©˜í…€)
        require_above_vwap: true      # VWAP ìœ„ í•„ìˆ˜

      # ğŸ”§ 2026-02-08 R2: Override ë‚¨ìš© ë°©ì§€
      override_abuse_guard:
        enabled: true
        max_override_ratio_pct: 30    # override / ef_no_follow ì°¨ë‹¨ ë¹„ìœ¨ ìƒí•œ (30%)
        min_samples: 3                # ìµœì†Œ ì°¨ë‹¨ íšŸìˆ˜ (ì´í•˜ë©´ ë¹„ìœ¨ íŒë‹¨ ì•ˆ í•¨)
        action: "disable_today"       # disable_today | warn_only

      # ğŸ”§ 2026-02-08: ì¢…ê°€ ì „ìš© Override (14:30~15:20)
      # â— T3 ì‹¤ë§¤ë§¤ ë¡œê·¸ ê²€ì¦ ì „ê¹Œì§€ OFF
      close_override:
        enabled: false                    # â† T3 í†µê³¼ ì „ê¹Œì§€ OFF
        time_start: "14:30"               # ì¢…ê°€ êµ¬ê°„ ì‹œì‘
        time_end: "15:20"                 # ì¢…ê°€ êµ¬ê°„ ì¢…ë£Œ
        require_above_vwap: true          # close > VWAP í•„ìˆ˜
        require_above_ema20: true         # close > EMA20 í•„ìˆ˜
        volume_ratio_min: 1.5             # ìµœê·¼ 5ë´‰ avg / 20ë´‰ avg â‰¥ 1.5
        volume_lookback: 5                # ìµœê·¼ ê±°ë˜ëŸ‰ í‰ê·  ë´‰ ìˆ˜
        # ì¢…ê°€ ì§„ì… ì‹œ í•„í„° ì¡°ì • (mainì—ì„œ ì°¸ì¡°)
        entry_filter_overrides:
          min_choch_grade: "B"            # CHoCH ë“±ê¸‰ ì™„í™” (í‰ì†Œ A â†’ B)
          min_hold_minutes: 10            # ìµœì†Œ ë³´ìœ  ì‹œê°„ ì¶•ì†Œ (í‰ì†Œ 20~30)
          disable_ef_check: true          # ì¢…ê°€ ì§„ì…ì—ëŠ” EF ê´€ì°° ë¹„í™œì„±í™”
          stop_atr_multiplier: 0.5        # ì†ì ˆ ATR ë°°ìˆ˜ ì¶•ì†Œ (í‰ì†Œ 0.7)

    # ğŸ”§ 2026-02-10: Market Sensor (EF ê¸°ë°˜ ì‹œì¥ ìƒíƒœ íŒë³„ â†’ ì§„ì… ì°¨ë‹¨)
    # EFë¥¼ ì†ì ˆ ë„êµ¬ â†’ ì‹œì¥ íŒë³„ ì„¼ì„œë¡œ ê²©ìƒ
    # ê·œì¹™ â‘ : ì˜¤ì „ EF NíšŒ â†’ ì˜¤í›„ ì§„ì… ì¤‘ë‹¨
    # ê·œì¹™ â‘¡: no_follow NíšŒ ëˆ„ì  â†’ Risk OFF Day
    market_sensor:
      enabled: true
      morning_ef_limit: 2              # ì˜¤ì „ EF 2íšŒ â†’ ì˜¤í›„ ì§„ì… ì°¨ë‹¨
      morning_cutoff: "12:00"          # ì˜¤ì „/ì˜¤í›„ êµ¬ë¶„ ì‹œê°
      risk_off_no_follow_limit: 3      # no_follow 3íšŒ ëˆ„ì  â†’ Risk OFF Day (ì‹ ê·œ ì§„ì… ì „ë©´ ì¤‘ë‹¨)

risk_management:
  initial_capital: 10000000
  daily_target_profit_pct: 2.0 # ğŸ¯ ì¼ì¼ ëª©í‘œ ìˆ˜ìµ 2% (ì•½ 7,500ì›)
  daily_max_loss_pct: 2.0      # ì¼ì¼ ì†ì‹¤ 2%
  max_drawdown_pct: 10.0
  max_trades_per_day: 15       # ğŸ“Š DATA: ê±°ë˜ ë°ì´í„° ê¸°ë°˜ (10â†’15)
  max_consecutive_losses: 3

  # ğŸ”§ Phase 3: ì—°ì† ì†ì‹¤ ëŒ€ì‘ ì •ì±…
  on_consecutive_loss_action: "halt_day"  # "halt_day" (ë‹¹ì¼ ì¤‘ì§€) or "reduce_size" (í¬ì§€ì…˜ ì¶•ì†Œ)
  loss_size_reduction: 0.5                # reduce_size ì„ íƒ ì‹œ í¬ì§€ì…˜ í¬ê¸° ì¶•ì†Œ ë¹„ìœ¨ (50%)
  max_positions: 3             # ğŸ”§ CRITICAL FIX: ë™ì‹œ ë³´ìœ  ìµœëŒ€ 3ê°œ (ëˆ„ë½ í•­ëª© ì¶”ê°€)
  position_risk_pct: 1.0       # í¬ì§€ì…˜ë‹¹ ë¦¬ìŠ¤í¬ 1%
  min_rr_ratio: 1.5

  # ğŸ”§ REFACTOR: RiskManager ì¶”ê°€ ì„¤ì • (2026-01-17 ì‹œë®¬ë ˆì´ì…˜ ë°˜ì˜)
  # ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼: 8ì¼ê°„ ìŠ¹ë¥  50.7%, ì´ ìˆ˜ìµ +19,840ì› (8ë§Œì› ê¸°ì¤€)
  min_cash_reserve_pct: 10     # ìµœì†Œ í˜„ê¸ˆ ë³´ìœ  ë¹„ìœ¨ 10% (20â†’10, ì ê·¹ì )
  max_position_size_pct: 40    # í¬ì§€ì…˜ë‹¹ ìµœëŒ€ 40% (30â†’40, ì ê·¹ì )
  hard_max_position: 500000    # í•˜ë“œ í¬ì§€ì…˜ ì œí•œ 50ë§Œì› (30ë§Œâ†’50ë§Œ, ì ê·¹ì )

risk_control:
  max_daily_loss_pct: 3.0      # SignalOrchestrator L0 í•„í„°ìš© (ì¼ì¼ ì†ì‹¤ í•œë„)
  max_weekly_loss_pct: 5.0     # ğŸ”§ REFACTOR: ì£¼ê°„ ì†ì‹¤ í•œë„ 5%
  hard_stop_pct: 2.0           # ğŸ“Š ML ê°œì„  (2025-12-16): -2.5% â†’ -2.0% (ì‹¤ì œ ì†ì‹¤ -2.61%, -3.09% ë°©ì§€)
  technical_stop_pct: 1.5      # ê¸°ìˆ ì  ì†ì ˆì„  -1.5%

  # ì´ˆê¸° ì‹¤íŒ¨ ì»· (ì†ìµë¹„ ê°œì„ ì˜ í•µì‹¬)
  early_failure:
    enabled: true              # í™œì„±í™”
    window_minutes: 30         # ğŸ“Š ML: 30ë¶„ìœ¼ë¡œ ì—°ì¥ (ì´ˆë‹¨íƒ€ ë°©ì§€, í‰ê·  ìŠ¹ë¦¬ ë³´ìœ  124ë¶„)
    loss_cut_pct: -1.6         # ğŸ“Š DATA: ì‹¤ì œ í‰ê·  ì†ì‹¤ -2.03%ì˜ 80% = -1.6%

  # ğŸ”§ Phase 3: ìµœì†Œ ë³´ìœ  ì‹œê°„ ê°•ì œ (ì´ˆë‹¨íƒ€ ë°©ì§€)
  min_hold_time:
    enabled: true              # ìµœì†Œ ë³´ìœ  ì‹œê°„ ê°•ì œ í™œì„±í™”
    minutes: 30                # ğŸ“Š DATA: íŒ¨ë°° í‰ê·  9ë¶„ vs ìŠ¹ë¦¬ í‰ê·  124ë¶„ â†’ 30ë¶„ ê¶Œì¥

  # ğŸ”§ 2026-02-06: êµ¬ì¡° ê¸°ë°˜ ì†ì ˆ (SMC ì „ëµ)
  # ê³ ì • í¼ì„¼íŠ¸ ì†ì ˆ â†’ êµ¬ì¡° ì €ì /HL - ATR ë²„í¼
  # í¬ì§€ì…˜ í¬ê¸° = (ê³„ì¢Œ Ã— 2%) / (ì§„ì…ê°€ - êµ¬ì¡°ì†ì ˆê°€)
  structure_based_stop:
    enabled: true                      # êµ¬ì¡° ê¸°ë°˜ ì†ì ˆ í™œì„±í™”
    atr_buffer_mult: 0.5               # êµ¬ì¡°ì  ì•„ë˜ ATR Ã— 0.5 ë²„í¼
    max_stop_pct: 3.0                  # ìµœëŒ€ ì†ì ˆ í­ cap (3%)

  # ğŸ”§ 2026-02-06: ì¡°ê±´ë¶€ ìµœì†Œ ë³´ìœ  ì‹œê°„ ì—°ì¥
  # HTF ì¶”ì„¸ ì¼ì¹˜ + ATR í™•ì¥ + ê±°ë˜ëŸ‰ í‰ê·  ì´ìƒ ì¤‘ 2ê°œ ì¶©ì¡± ì‹œ ë³´ìœ  ì‹œê°„ ì—°ì¥
  conditional_hold:
    enabled: true                      # ì¡°ê±´ë¶€ ë³´ìœ  í™œì„±í™”
    min_conditions: 2                  # ìµœì†Œ ì¶©ì¡± ì¡°ê±´ ìˆ˜
    hold_multiplier: 1.5               # ì¡°ê±´ ì¶©ì¡± ì‹œ ë³´ìœ ì‹œê°„ ë°°ìˆ˜ (1.5x)

  # ğŸ”§ 2026-02-07: Early Failure Structure Filter (ë¹ ë¥¸ êµ¬ì¡° ì‹¤íŒ¨ ê°ì§€)
  # ì§„ì… í›„ 2~3ìº”ë“¤(5~15ë¶„) ì´ë‚´ ì‹¤íŒ¨ ì‹ í˜¸ ê°ì§€ â†’ ì¡°ê¸° íƒˆì¶œ
  # Score: direction_fail(2) + atr_decay(1) + volume_dry(1) >= 3
  early_failure_structure:
    enabled: true                      # Early Failure êµ¬ì¡° í•„í„° í™œì„±í™”
    min_observe_minutes: 5             # ìµœì†Œ ê´€ì°° ì‹œê°„ (ë¶„)
    observe_minutes: 15                # ìµœëŒ€ ê´€ì°° êµ¬ê°„ (ë¶„)
    score_threshold: 3                 # ì¡°ê¸° ì²­ì‚° ì„ê³„ê°’
    atr_decay_ratio: 0.85             # ATR ê°ì‡  ë¹„ìœ¨ (< 0.85 = ëª¨ë©˜í…€ ì†Œì‹¤)
    volume_dry_ratio: 0.8             # ê±°ë˜ëŸ‰ ê³ ê°ˆ ë¹„ìœ¨ (< 0.8 = ê³ ê°ˆ)
    mfe_ratio: 0.25                   # MFE ì‹¤íŒ¨ ë¹„ìœ¨ (MFE < ATR Ã— 0.25 = ë°©í–¥ì„± ë¶€ì¡±)
    follow_through_candles: 3          # ì¶”ì¢… ì‹¤íŒ¨ ìº”ë“¤ ìˆ˜ (Nìº”ë“¤ ì¢…ê°€ ëª¨ë‘ ì§„ì…ê°€ ë°˜ëŒ€)
    action: "exit_market"              # exit_market | reduce_half | trail_stop

  # ğŸ”§ 2026-01-27: ì˜¤ë²„ë‚˜ì‡ ì „ìš© Exit ë¡œì§ (ì•„ì§„ì—‘ìŠ¤í… ì‚¬ë¡€ ë°˜ì˜)
  # ì „ì¼ ì§„ì…ë¶„ â‰  ë‹¹ì¼ ì§„ì…ë¶„ - ì‹œì´ˆê°€ ë³€ë™ì„± ë³´í˜¸
  overnight_exit:
    enabled: true                           # ì˜¤ë²„ë‚˜ì‡ Exit ë¡œì§ í™œì„±í™”
    morning_protection_start: "09:00:00"    # ë³´í˜¸ êµ¬ê°„ ì‹œì‘
    morning_protection_end: "09:30:00"      # ë³´í˜¸ êµ¬ê°„ ì¢…ë£Œ
    use_open_range: true                    # Open Range (09:00~09:30) ê¸°ë°˜ ìŠ¤íƒ‘ ì‚¬ìš©
    open_range_multiplier: 1.5              # OR Low - (OR Range Ã— 1.5) ì´íƒˆ ì‹œ ì²­ì‚°

  # ğŸ”§ 2026-01-27: ë¬´ìŠ¹ë¶€(Draw) ê±°ë˜ ì •ì˜
  # +0.2% ë¯¸ë§Œ & 6ì‹œê°„+ ë³´ìœ  = WIN/LOSSê°€ ì•„ë‹Œ DRAWë¡œ ë¶„ë¥˜
  draw_trade:
    enabled: true                           # Draw ë¶„ë¥˜ í™œì„±í™”
    profit_threshold_pct: 0.2               # +0.2% ë¯¸ë§Œì€ Draw (ìˆ˜ìˆ˜ë£Œ ê³ ë ¤)
    min_hold_hours: 6                       # 6ì‹œê°„ ì´ìƒ ë³´ìœ  ì‹œ ì ìš©

partial_exit:
  enabled: false               # âŒ ë¹„í™œì„±í™”: MA Cross ë‹¨ìˆœ ì „ëµ (ë¶€ë¶„ ì²­ì‚° ì—†ìŒ)
  tiers:
    # ğŸ“Š ML ê°œì„  (2025-12-15): ì†ìµë¹„ 0.38 â†’ ìµì ˆ íƒ€ê²Ÿ ìƒí–¥
    # ì´ë²ˆì£¼ ë¶„ì„: í‰ê·  ìŠ¹ë¦¬ +0.65% vs í‰ê·  ì†ì‹¤ -1.70% â†’ ë” ëŠ¦ê²Œ, ë” ì ê²Œ ì²­ì‚°
    - profit_pct: 1.5          # +1.5%ì— 30% ì²­ì‚° (ê¸°ì¡´ +0.7% 40% â†’ ìƒí–¥)
      exit_ratio: 0.3
    - profit_pct: 2.5          # +2.5%ì— 30% ì²­ì‚° (ê¸°ì¡´ +1.1% 40% â†’ ìƒí–¥)
      exit_ratio: 0.3
    # ë‚˜ë¨¸ì§€ 40%ëŠ” íŠ¸ë ˆì¼ë§ ìŠ¤í†±ìœ¼ë¡œ ì¶”ê°€ ìˆ˜ìµ ì¶”êµ¬ (ê¸°ì¡´ 20% â†’ 40%)

# âŒ íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ ë¹„í™œì„±í™” (MA Cross ë‹¨ìˆœ ì „ëµ)
# trailing_stop:
#   activation_profit_pct: 2.5
#   distance_pct: 0.8
#   min_lock_profit_pct: 0.3

# âŒ VWAP ì²­ì‚° ë¹„í™œì„±í™” (MA Cross ë‹¨ìˆœ ì „ëµ)
# vwap_exit:
#   profit_threshold_for_ignore: 2.0
#   multi_condition_required: true

# ========================================
# âœ… Squeeze Momentum ì „ëµ ì„¤ì • (LazyBear)
# ========================================
squeeze_momentum:
  enabled: true                      # ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ í™œì„±í™”

  # ì§„ì… ì¡°ê±´ ëª¨ë“œ ì„ íƒ
  # "squeeze_only"           : ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ë§Œ ì‚¬ìš© (ê¸°ì¡´ L0-L6 í•„í„° ë¬´ì‹œ)
  # "squeeze_with_orderbook" : ìŠ¤í€´ì¦ˆ + í˜¸ê°€ì°½ í†µí•© ì „ëµ (Phase 1 í•„í„°)
  # "legacy_only"            : ê¸°ì¡´ í•„í„°ë§Œ ì‚¬ìš© (ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ ë¬´ì‹œ)
  # "hybrid"                 : ë‘˜ ë‹¤ ì‚¬ìš© (ê¸°ì¡´ í•„í„° + ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€)
  # "ma_cross"               : MA ê³¨ë“ í¬ë¡œìŠ¤/ë°ë“œí¬ë¡œìŠ¤ ì „ëµ (5ë¶„ë´‰ MA5/MA10)
  # "squeeze_2tf"            : 2-íƒ€ì„í”„ë ˆì„ ì „ëµ (30ë¶„ë´‰ MA5/MA20 + Squeeze + í•˜ìœ„ë´‰ ì§„ì…)
  # "smc"                    : SMC (Smart Money Concepts) - CHoCH + Liquidity Sweep
  # entry_mode: "ma_cross"  # ëŒ€ê¸°: 5ë¶„ë´‰ MA ê³¨ë“ í¬ë¡œìŠ¤ ì „ëµ
  # entry_mode: "squeeze_2tf"  # 30ë¶„ë´‰ + Squeeze + 5ë¶„ë´‰ ì§„ì…
  entry_mode: "smc"        # âœ… í˜„ì¬: SMC ì „ëµ (CHoCH + Liquidity Sweep)

  # ì§„ì… í•„í„°
  entry_filter:
    enabled: true                    # ì§„ì… ì‹œ ìŠ¤í€´ì¦ˆ ì²´í¬ í™œì„±í™”
    require_bright_green: true       # Bright Green (ê°€ì†) í•„ìˆ˜
    min_momentum: 0.0                # ìµœì†Œ ëª¨ë©˜í…€ ê°’

  # âœ… í˜¸ê°€ì°½ í•„í„° (Phase 1 ë³´ìˆ˜ì  í•„í„°)
  orderbook_filter:
    enabled: true                    # í˜¸ê°€ì°½ í•„í„° í™œì„±í™”

    # ì§„ì… ì¡°ê±´ (6ê°œ)
    entry_conditions:
      volume_surge_mult: 1.3         # ê±°ë˜ëŸ‰ ê¸‰ì¦ (5ë¶„ vs ì´ì „ 5ë¶„)
      sell_decrease_ratio: 0.8       # ë§¤ë„ 1í˜¸ê°€ ê°ì†Œ (1ë¶„ í‰ê·  ëŒ€ë¹„)
      price_stable_max_sec: 5        # ê°€ê²© ì •ì²´ ìµœëŒ€ í—ˆìš© (ì´ˆ)
      execution_strength_min: 90.0   # ìµœì†Œ ì²´ê²°ê°•ë„ (ì ˆëŒ€ê°’)
      execution_strength_mult: 1.1   # ì¢…ëª©ë³„ ìƒëŒ€ ì²´ê²°ê°•ë„ (20ì¼ í‰ê·  ëŒ€ë¹„)

    # ì§„ì… ê¸ˆì§€ ì¡°ê±´ (3ê°œ)
    entry_blockers:
      chase_prevention_pct: 2.0      # ê¸‰ë“± í›„ ê³ ì  ëŒ€ë¹„ -2% ì´ìƒ í•˜ë½ ì‹œ ì§„ì… ê¸ˆì§€
      sell_surge_ratio: 1.3          # ë§¤ë„í˜¸ê°€ ê¸‰ì¦ (+30% ì´ìƒ) ì‹œ ê¸ˆì§€
      weak_execution_min: 90.0       # ì•½í•œ ì²´ê²°ê°•ë„ (<90%) ì°¨ë‹¨

    # ë“€ì–¼ ì†ì ˆ êµ¬ì¡°
    stop_loss:
      vwap_rapid_pct: 0.8            # ê¸‰ë½ ì†ì ˆ: VWAP -0.8%
      vwap_trend_enabled: true       # ì¶”ì„¸ ì†ì ˆ í™œì„±í™”
      trend_execution_min: 80.0      # ì¶”ì„¸ ì†ì ˆ: 5ë¶„ VWAP ì´íƒˆ + ì²´ê²°ê°•ë„ < 80%

    # ì°¨ë“± ì¿¨ë‹¤ìš´
    cooldown:
      crash_minutes: 30              # ê¸‰ë½ ì†ì ˆ (â‰¥2% ì†ì‹¤) ì¿¨ë‹¤ìš´
      trend_minutes: 15              # ì¶”ì„¸ ë¶•ê´´ ì†ì ˆ ì¿¨ë‹¤ìš´
      strategy_minutes: 0            # ì „ëµ ì²­ì‚° ì¿¨ë‹¤ìš´ (ì—†ìŒ)

  # âŒ ì²­ì‚° í•„í„° ë¹„í™œì„±í™” (MA Cross ë‹¨ìˆœ ì „ëµ: ë°ë“œí¬ë¡œìŠ¤ë§Œ ì‚¬ìš©)
  exit_filter:
    enabled: false                   # ì²­ì‚° ì‹œ ìŠ¤í€´ì¦ˆ ì²´í¬ ë¹„í™œì„±í™”

    # Dark Green (ê°ì†) - ë¶€ë¶„ ìµì ˆ (íœ´ë¦¼ë¡œë´‡ ì„±ê³µ ì‚¬ë¡€)
    dark_green:
      enabled: false
      partial_exit_ratio: 0.3        # 30% ë¶€ë¶„ ìµì ˆ
      min_profit_pct: 1.0            # ìµœì†Œ ìˆ˜ìµë¥  1%

    # Red (ë°˜ì „) - ì „ëŸ‰ ì²­ì‚°
    red:
      enabled: false
      full_exit: true                # ì „ëŸ‰ ì²­ì‚°
      min_profit_pct: 0.5            # ìµœì†Œ ìˆ˜ìµë¥  0.5%

    # Bright Green (ê°€ì†) - ë³´ìœ  í•„ìˆ˜ (ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ êµí›ˆ)
    bright_green:
      force_hold: false              # ê°•ì œ ë³´ìœ  ë¹„í™œì„±í™”
      ignore_trailing_stop: false    # íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ì€ ìœ ì§€ (ê³¼ë„í•œ ì†ì‹¤ ë°©ì§€)

  # ì§€í‘œ íŒŒë¼ë¯¸í„°
  parameters:
    bb_length: 20                    # Bollinger Bands ê¸°ê°„
    bb_mult: 2.0                     # Bollinger Bands ë°°ìˆ˜
    kc_length: 20                    # Keltner Channel ê¸°ê°„
    kc_mult: 1.5                     # Keltner Channel ë°°ìˆ˜
    mom_length: 20                   # ëª¨ë©˜í…€ ê³„ì‚° ê¸°ê°„

  # ì‹¤ì „ í†µê³„ (docs/1231 ë¶„ì„ ê¸°ë°˜)
  stats:
    tested_stocks: ["íœ´ë¦¼ë¡œë´‡", "ëª¨ë¹„ìŠ¤", "ì‚¼ë³´ëª¨í„°ìŠ¤", "ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ"]
    success_rate: 0.25               # ì‹ í˜¸ ì¼ì¹˜ìœ¨ 25% (1/4)
    best_case: "íœ´ë¦¼ë¡œë´‡"            # Dark Green ë¶€ë¶„ ìµì ˆ ì„±ê³µ
    worst_case: "ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ"     # Bright Green ì¡°ê¸° ìµì ˆë¡œ 8ë°° ìˆ˜ìµ ìƒì‹¤

# âŒ ì‹œê°„ ê¸°ë°˜ ì²­ì‚° ë¹„í™œì„±í™” (MA Cross ë‹¨ìˆœ ì „ëµ: ë°ë“œí¬ë¡œìŠ¤ë§Œ ì‚¬ìš©)
# time_based_exit:
#   loss_breakeven_exit_time: "15:00:00"
#   final_force_exit_time: "15:05:00"
#   loss_breakeven_threshold_pct: 0.0

# ========================================
# âœ… ChatGPT ë¦¬ë·° ë°˜ì˜: EOD ì •ì±… ì¶”ê°€
# ========================================
eod_policy:
  enabled: false                         # âŒ ë¹„í™œì„±í™”: ì‹œê°„ ê¸°ë°˜ ê°•ì œ ì²­ì‚° ì—†ìŒ
  check_time: "14:55:00"                 # âœ… ìˆ˜ì •: 14:55 (15:00ì—ì„œ ë³€ê²½, API ì§€ì—° ê³ ë ¤)
  force_exit_time: "15:05:00"            # âœ… ìˆ˜ì •: 15:05 (15:10ì—ì„œ ë³€ê²½)
  max_overnight_positions: 3             # ìµœëŒ€ ìµì¼ ë³´ìœ  ì¢…ëª© ìˆ˜
  min_overnight_score: 0.6               # ìµœì†Œ ë³´ìœ  ì ìˆ˜ (0.0-1.0)
  max_overnight_position_value_pct: 40  # âœ… ì¶”ê°€: ê³„ì¢Œ ìì‚°ì˜ 40%ê¹Œì§€ë§Œ ìµì¼ ë³´ìœ 

  # ìµì¼ ë³´ìœ  ê¸°ì¤€
  overnight_criteria:
    trend_weight: 0.4                    # ì¶”ì„¸ ê°€ì¤‘ì¹˜
    volume_weight: 0.3                   # ê±°ë˜ëŸ‰ ê°€ì¤‘ì¹˜
    news_weight: 0.3                     # ë‰´ìŠ¤/ì¬ë£Œ ê°€ì¤‘ì¹˜

    min_ema_state: true                  # EMA5 > EMA20 í•„ìˆ˜
    min_vol_z20: 1.0                     # ìµœì†Œ ê±°ë˜ëŸ‰ Z-score
    min_news_score: 50                   # ìµœì†Œ ë‰´ìŠ¤ ì ìˆ˜

  # âœ… ì¶”ê°€: ìš°ì„  ê°ì‹œ ë¦¬ìŠ¤íŠ¸ ì¡°ê±´ (ğŸ”¥ ChatGPT Fix: ì¡°ê±´ ê°•í™”)
  priority_watchlist:
    min_eod_score: 0.65                  # ìµœì†Œ EOD ì ìˆ˜ (0.55 â†’ 0.65)
    min_close_to_high_ratio: 0.88        # ì¢…ê°€/ê³ ê°€ ìµœì†Œ 88% (0.8 â†’ 0.88)
    min_vol_z20: 1.2                     # ìµœì†Œ ê±°ë˜ëŸ‰ Z-score (1.0 â†’ 1.2)
    min_news_score: 50                   # ìµœì†Œ ë‰´ìŠ¤ ì ìˆ˜ (45 â†’ 50, ì¤‘ë¦½ ì´ìƒ)

# ========================================
# âœ… ChatGPT ë¦¬ë·° ë°˜ì˜: ê°­ì—… ì¬ì§„ì… ì„¤ì •
# ========================================
gap_reentry:
  enabled: true
  gap_threshold_pct: 3.0                 # ê°­ì—… ê¸°ì¤€ (%)
  volume_z_threshold: 2.0                # ê±°ë˜ëŸ‰ Z-score ê¸°ì¤€
  check_window_minutes: 30               # ì²´í¬ ì‹œê°„ (ì¥ ì‹œì‘ í›„ 30ë¶„)
  reentry_confidence: 0.7                # ì¬ì§„ì… ì‹ ë¢°ë„
  first_candle_window: 5                 # âœ… ìˆ˜ì •: 3-5ë¶„ë´‰ ê¸°ì¤€ (1ë¶„ë´‰ì—ì„œ ì™„í™”)

logging:
  enabled: true
  log_dir: "logs"
  log_level: "INFO"

test:
  stock_symbols:
    - "005930"
    - "015760"
  data_days: 7
  interval: "5m"

# ========================================
# Bottom Pullback ì „ëµ ì„¤ì • (ì¡°ê±´ 23ë²ˆ)
# ========================================
condition_strategies:
  # ê¸°ì¡´ ëª¨ë©˜í…€ ì „ëµ (17-22ë²ˆ)
  momentum:
    condition_indices: [17, 18, 19, 20, 21, 22]
    strategy_tag: "momentum"
    immediate_entry: true
    description: "ê¸°ì¡´ ì¦‰ì‹œ ë§¤ìˆ˜ ì „ëµ (VWAP + L0-L6 í•„í„°)"

  # Bottom Pullback ì „ëµ (23ë²ˆ)
  bottom_pullback:
    condition_indices: [23]
    strategy_tag: "bottom_pullback"
    immediate_entry: false
    wait_for_pullback: true
    max_entries_per_day: 1
    description: "ì¡°ê±´ ì‹ í˜¸ â†’ VWAP Pullback ëŒ€ê¸° â†’ ì¬ëŒíŒŒ ì‹œ ì§„ì…"

    # Pullback ì¡°ê±´ ì •ì˜
    pullback:
      type: "vwap_reclaim"
      allow_below_vwap: true                    # VWAP ì´íƒˆ í—ˆìš©
      invalidate_if_break_signal_low: true      # ì‹ í˜¸ë´‰ ì €ê°€ ì´íƒˆ ì‹œ ë¬´íš¨í™”

      # âœ… VWAP ì´íƒˆ ì¡°ê±´ (ì •ëŸ‰í™”)
      break_conditions:
        vwap_break_threshold_pct: -0.3          # VWAP ëŒ€ë¹„ -0.3% ì´ìƒ ì´íƒˆ ì‹œ ê°ì§€
                                                # (ì‘ì€ ë…¸ì´ì¦ˆ ë¬´ì‹œ, ì˜ë¯¸ìˆëŠ” ì´íƒˆë§Œ ì¸ì •)

      # âœ… VWAP ì¬ëŒíŒŒ ì¡°ê±´ (ì •ëŸ‰í™”)
      reclaim_conditions:
        vwap_reclaim_threshold_pct: 0.2         # VWAP ëŒ€ë¹„ +0.2% ì´ìƒ ëŒíŒŒ ì‹œ ê°ì§€
                                                # (í™•ì‹¤í•œ ì¬ëŒíŒŒë§Œ ì¸ì •)
        min_volume_ratio: 1.0                   # ëŒíŒŒ ë´‰ ê±°ë˜ëŸ‰ â‰¥ ì§ì „ 5ë´‰ í‰ê· 
        confirm_candles: 1                       # ì¬ëŒíŒŒ í›„ í™•ì¸ ë´‰ ìˆ˜

      # ë¬´íš¨í™” ì¡°ê±´
      invalidation:
        break_signal_low_pct: -0.5              # ì‹ í˜¸ë´‰ ì €ê°€ -0.5% ì´íƒˆ ì‹œ ë¬´íš¨
        max_wait_minutes: 180                   # ê¸°ë³¸ ìµœëŒ€ ëŒ€ê¸° ì‹œê°„ 3ì‹œê°„

        # âœ… ë™ì  ì‹œê°„ ì œí•œ (ë³€ë™ì„± ê¸°ë°˜)
        use_dynamic_timeout: true               # ë™ì  ì‹œê°„ ì œí•œ í™œì„±í™”
        high_volatility_minutes: 120            # ê³ ë³€ë™ì„±: 2ì‹œê°„
        low_volatility_minutes: 240             # ì €ë³€ë™ì„±: 4ì‹œê°„
        volatility_threshold_high: 3.0          # ê³ ë³€ë™ì„± ê¸°ì¤€: ATR% >= 3.0
        volatility_threshold_low: 1.5           # ì €ë³€ë™ì„± ê¸°ì¤€: ATR% <= 1.5

      # ì‹œê°„ ì œí•œ
      time_window:
        start: "09:30"                          # ì§„ì… ê°€ëŠ¥ ì‹œì‘ ì‹œê°„
        end: "14:30"                            # ì§„ì… ê°€ëŠ¥ ì¢…ë£Œ ì‹œê°„

# ========================================
# SMC (Smart Money Concepts) ì „ëµ ì„¤ì •
# ========================================
smc:
  enabled: true                        # SMC ì „ëµ í™œì„±í™”

  # ìŠ¤ìœ™ í¬ì¸íŠ¸ ì„¤ì •
  swing_lookback: 5                    # ìŠ¤ìœ™ íƒì§€ ì¢Œìš° ë¹„êµ ë´‰ ìˆ˜
  min_swing_size_pct: 0.3              # ìµœì†Œ ìŠ¤ìœ™ í¬ê¸° (%) - ë…¸ì´ì¦ˆ ì œê±°

  # ìœ ë™ì„± ìŠ¤ìœ• ì„¤ì •
  sweep_threshold_pct: 0.1             # ìŠ¤ìœ• ì¸ì • ìµœì†Œ ëŒíŒŒìœ¨ (%)
  sweep_lookback: 20                   # ìœ ë™ì„± ìŠ¤ìœ• íƒìƒ‰ ë²”ìœ„

  # ì§„ì… ì¡°ê±´
  require_liquidity_sweep: true        # ğŸ”§ 2026-01-23: Sweep í•„ìˆ˜ (CHoCH ë‹¨ë… ì§„ì… ì°¨ë‹¨)
  long_only: true                      # ë¡±ë§Œ ì§„ì… (ìˆ ì‹ í˜¸ ë¬´ì‹œ)

  # ì˜¤ë”ë¸”ë¡ ì„¤ì •
  ob_lookback: 10                      # ì˜¤ë”ë¸”ë¡ íƒìƒ‰ ë²”ìœ„

  # íƒ€ì„í”„ë ˆì„
  analysis_timeframe: "5min"           # SMC ë¶„ì„ íƒ€ì„í”„ë ˆì„

  # ğŸ”§ 2026-01-23: CHoCH ë“±ê¸‰ í•„í„° (ê³¼ì§„ì… ë°©ì§€)
  choch_grade:
    enabled: true                      # ë“±ê¸‰ í•„í„° í™œì„±í™”
    min_grade: "B"                     # ìµœì†Œ í—ˆìš© ë“±ê¸‰ (A/B/C) - Cê¸‰ ì°¨ë‹¨
    grade_b_weight: 0.5                # Bê¸‰ CHoCH ë¹„ì¤‘ ë°°ìœ¨ (50%)
    # Aê¸‰: HTF êµ¬ì¡° ì¼ì¹˜ + Sweep + OB ëª…í™• + Squeeze ìˆ˜ì¶• (70ì +)
    # Bê¸‰: ì¼ë¶€ ì¡°ê±´ ë¯¸ì¶©ì¡± (40-69ì )
    # Cê¸‰: íš¡ë³´ ë‚´ CHoCH, ì €í’ˆì§ˆ (40ì  ë¯¸ë§Œ) â†’ ì§„ì… ê¸ˆì§€

  # ğŸ”§ 2026-01-23: ì¶”ê°€ ì§„ì… í•„í„° (ì˜µì…˜)
  additional_filters:
    require_squeeze_on: false          # Squeeze ON ìƒíƒœ í•„ìˆ˜ (ì—ë„ˆì§€ ì¶•ì  í™•ì¸)
    require_vwap_above: false          # VWAP ìœ„ í•„ìˆ˜ (ì¶”ì„¸ í™•ì¸)

  # ğŸ”§ 2026-01-29: MTF Bias í•„í„° (30ë¶„ë´‰ ì¶”ì„¸ ì²´í¬)
  # LONG ì§„ì… ì‹œ 30ë¶„ë´‰ì´ í•˜ë½ ì¶”ì„¸ë©´ ì§„ì… ì°¨ë‹¨
  # â†’ ì¶”ì„¸ì— ì—­í–‰í•˜ëŠ” "ë°©í–¥ ì‹¸ì›€" ê±°ë˜ ë°©ì§€ (DRAW ë°œìƒ í•µì‹¬ ì›ì¸)
  mtf_bias:
    enabled: true                      # MTF Bias í•„í„° í™œì„±í™”
    timeframe: "30min"                 # ìƒìœ„ íƒ€ì„í”„ë ˆì„ (30ë¶„ë´‰)
    # í•˜ë½ ì¶”ì„¸ ì •ì˜: Lower High + Lower Low íŒ¨í„´
    # ìƒìŠ¹ ì¶”ì„¸ ì •ì˜: Higher High + Higher Low íŒ¨í„´
    # ì¤‘ë¦½: íŒ¨í„´ ë¶ˆëª…í™• â†’ LONG í—ˆìš©

  # ğŸ”§ 2026-02-06: SMC ì§„ì… í”„ë¦¬í•„í„° (ì§„ì… í’ˆì§ˆ ê°œì„ )
  # CHoCH ê°ì§€ í›„ 3ê°€ì§€ ì¡°ê±´ ì¤‘ min_conditions ì´ìƒ ì¶©ì¡± ì‹œë§Œ ì§„ì…
  # ëª©í‘œ: ìŠ¹ë¥  16.7% â†’ 30~35%, ì§„ì… ìˆ˜ 50% ê°ì†Œ
  entry_prefilter:
    enabled: true                      # í”„ë¦¬í•„í„° í™œì„±í™”
    min_conditions: 2                  # ìµœì†Œ ì¶©ì¡± ì¡°ê±´ ìˆ˜ (3ê°œ ì¤‘ 2ê°œ)
    require_htf_trend: true            # ì¡°ê±´1: HTF ì¶”ì„¸ ìƒì¡´ ì²´í¬
    require_liquidity_sweep: true      # ì¡°ê±´2: ìœ ë™ì„± ì²­ì‚° í™•ì¸
    require_reclaim: true              # ì¡°ê±´3: ë˜ëŒë¦¼ ìº”ë“¤ í™•ì¸
    reclaim_lookback: 5                # CHoCH í›„ ëª‡ ìº”ë“¤ ë‚´ ë˜ëŒë¦¼ í™•ì¸
    reclaim_tolerance_pct: 0.3         # broken level ëŒ€ë¹„ í—ˆìš© ë²”ìœ„ (%)
