# í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ (ê¶Œì¥)
# ê³µê²©ì  + ë³´ìˆ˜ì  + ë¶€ë¶„ì²­ì‚°ì˜ ì¥ì  ê²°í•©

trailing:
  activation_pct: 1.5        # ë¬¸ì„œ ëª…ì„¸: íŠ¸ë ˆì¼ë§ í™œì„±í™” +1.5%
  ratio: 1.0                 # ë¬¸ì„œ ëª…ì„¸: íŠ¸ë ˆì¼ë§ ë¹„ìœ¨ -1.0%
  stop_loss_pct: 3.0         # ë¬¸ì„œ ëª…ì„¸: ê¸°ë³¸ ì†ì ˆ -3.0%

  use_profit_tier: true      # í° ìˆ˜ìµ ì‹œ ê°•í™” âœ…
  profit_tier_threshold: 6.0 # ğŸ”§ FIX: +6% ë„ë‹¬ ì‹œ (ë¬¸ì„œ ëª…ì„¸ ë°˜ì˜)
  profit_tier_ratio: 0.5     # 0.5%ë¡œ ê°•í™”

  use_atr_based: true        # ğŸ”§ FIX: ATR ê¸°ë°˜ íŠ¸ë ˆì¼ë§ í™œì„±í™” (ë¬¸ì„œ ëª…ì„¸)
  atr_multiplier: 1.3        # âœ… ChatGPT ë¦¬ë·°: ATRÃ—1.3 (1.5â†’1.3, ì½”ìŠ¤ë‹¥ ë³€ë™ì„± ê³ ë ¤)

filters:
  use_trend_filter: true
  trend_period: 20

  # ğŸ“Š ML ê°œì„  (2025-12-15): L1 ê±°ë˜ëŸ‰ í•„í„° ê°•í™”
  # ì´ë²ˆì£¼ ë¶„ì„: ì¡°ê¸° ì†ì ˆ 5ê±´ ë¹ˆë°œ â†’ ì§„ì… í’ˆì§ˆ ê°œì„  í•„ìš”
  use_volume_filter: true
  volume_multiplier: 1.5     # 1.2 â†’ 1.5 (ê±°ë˜ëŸ‰ ê¸°ì¤€ ìƒí–¥)

  use_breakout_confirm: false
  breakout_confirm_candles: 2

  use_volume_value_filter: false
  min_volume_value: 1000000000

  use_market_momentum: false

  use_daily_trend_filter: true

  # ğŸ“Š ML ê°œì„  (2025-12-15): L2 ë³€ë™ì„± í•„í„° ê°•í™”
  # ì´ë²ˆì£¼ ë¶„ì„: ì¡°ê¸° ì†ì ˆ 5ê±´ ë¹ˆë°œ â†’ ë³€ë™ì„± ê¸°ì¤€ ê°•í™”
  use_volatility_filter: true   # ìœ„í—˜ ì¢…ëª© ì œì™¸ âœ…
  min_atr_pct: 0.8             # 0.5 â†’ 0.8 (ë„ˆë¬´ ë‚®ì€ ë³€ë™ì„± ì œì™¸)
  max_atr_pct: 4.0             # 4.5 â†’ 4.0 (ë„ˆë¬´ ìœ„í—˜í•œ ì¢…ëª© ì œì™¸)

time_filter:
  use_time_filter: true        # ğŸ”§ FIX: ì¥ ì´ˆë°˜/ë§ˆê° íšŒí”¼ í™œì„±í™” (ë¬¸ì„œ ëª…ì„¸)
  market_open: "09:00"
  market_close: "15:20"
  avoid_early_minutes: 30      # ğŸ”§ FIX: 09:30ê¹Œì§€ íšŒí”¼ (ë¬¸ì„œ ëª…ì„¸) [ë³µì›: 10â†’30]
  avoid_late_minutes: 21       # ğŸ”§ FIX: 14:59ê¹Œì§€ë§Œ ì§„ì… (15:20-21=14:59) [ë³µì›: 10â†’21]

  # ğŸ“Š ML: ê±°ë˜ ë°ì´í„° ë¶„ì„ ê¸°ë°˜ ì‹œê°„ëŒ€ ê°€ì¤‘ì¹˜
  time_weight:
    morning_penalty: 0.5       # 09:30~12:00 ì‹ í˜¸ ê°€ì¤‘ì¹˜ 50% ê°ì†Œ (ìŠ¹ë¥  10%)
    # ğŸ“Š ML ê°œì„  (2025-12-16): ì ì‹¬ì‹œê°„ ì™„ì „ ì°¨ë‹¨
    # ì˜¤ëŠ˜ ë¶„ì„: 12:18-12:51 ê±°ë˜ë¡œ -1,683ì› ì†ì‹¤ â†’ ì™„ì „ ì°¨ë‹¨
    midday_penalty: 0.0        # 12:00~14:00 ì‹ í˜¸ ì™„ì „ ì°¨ë‹¨ (0.3 â†’ 0.0)
    afternoon_bonus: 1.5       # 14:00~14:59 ì‹ í˜¸ ê°€ì¤‘ì¹˜ 50% ì¦ê°€ (ìŠ¹ë¥  100%)

re_entry:
  use_cooldown: true           # ì¬ì§„ì… ë°©ì§€ âœ…
  cooldown_minutes: 20         # ì ì ˆí•œ ëŒ€ê¸° ì‹œê°„

risk_management:
  initial_capital: 10000000
  daily_target_profit_pct: 2.0 # ğŸ¯ ì¼ì¼ ëª©í‘œ ìˆ˜ìµ 2% (ì•½ 7,500ì›)
  daily_max_loss_pct: 2.0      # ì¼ì¼ ì†ì‹¤ 2%
  max_drawdown_pct: 10.0
  max_trades_per_day: 15       # ğŸ“Š DATA: ê±°ë˜ ë°ì´í„° ê¸°ë°˜ (10â†’15)
  max_consecutive_losses: 3

  # ğŸ”§ Phase 3: ì—°ì† ì†ì‹¤ ëŒ€ì‘ ì •ì±…
  on_consecutive_loss_action: "halt_day"  # "halt_day" (ë‹¹ì¼ ì¤‘ì§€) or "reduce_size" (í¬ì§€ì…˜ ì¶•ì†Œ)
  loss_size_reduction: 0.5                # reduce_size ì„ íƒ ì‹œ í¬ì§€ì…˜ í¬ê¸° ì¶•ì†Œ ë¹„ìœ¨ (50%)
  max_positions: 3             # ğŸ”§ CRITICAL FIX: ë™ì‹œ ë³´ìœ  ìµœëŒ€ 3ê°œ (ëˆ„ë½ í•­ëª© ì¶”ê°€)
  position_risk_pct: 1.0       # í¬ì§€ì…˜ë‹¹ ë¦¬ìŠ¤í¬ 1%
  min_rr_ratio: 1.5

  # ğŸ”§ REFACTOR: RiskManager ì¶”ê°€ ì„¤ì •
  min_cash_reserve_pct: 20     # ìµœì†Œ í˜„ê¸ˆ ë³´ìœ  ë¹„ìœ¨ 20%
  max_position_size_pct: 30    # í¬ì§€ì…˜ë‹¹ ìµœëŒ€ 30%
  hard_max_position: 300000    # í•˜ë“œ í¬ì§€ì…˜ ì œí•œ 30ë§Œì› (ì‹¤ê±°ë˜ ê³ ë ¤)

risk_control:
  max_daily_loss_pct: 3.0      # SignalOrchestrator L0 í•„í„°ìš© (ì¼ì¼ ì†ì‹¤ í•œë„)
  max_weekly_loss_pct: 5.0     # ğŸ”§ REFACTOR: ì£¼ê°„ ì†ì‹¤ í•œë„ 5%
  hard_stop_pct: 2.0           # ğŸ“Š ML ê°œì„  (2025-12-16): -2.5% â†’ -2.0% (ì‹¤ì œ ì†ì‹¤ -2.61%, -3.09% ë°©ì§€)
  technical_stop_pct: 1.5      # ê¸°ìˆ ì  ì†ì ˆì„  -1.5%

  # ì´ˆê¸° ì‹¤íŒ¨ ì»· (ì†ìµë¹„ ê°œì„ ì˜ í•µì‹¬)
  early_failure:
    enabled: true              # í™œì„±í™”
    window_minutes: 30         # ğŸ“Š ML: 30ë¶„ìœ¼ë¡œ ì—°ì¥ (ì´ˆë‹¨íƒ€ ë°©ì§€, í‰ê·  ìŠ¹ë¦¬ ë³´ìœ  124ë¶„)
    loss_cut_pct: -1.6         # ğŸ“Š DATA: ì‹¤ì œ í‰ê·  ì†ì‹¤ -2.03%ì˜ 80% = -1.6%

  # ğŸ”§ Phase 3: ìµœì†Œ ë³´ìœ  ì‹œê°„ ê°•ì œ (ì´ˆë‹¨íƒ€ ë°©ì§€)
  min_hold_time:
    enabled: true              # ìµœì†Œ ë³´ìœ  ì‹œê°„ ê°•ì œ í™œì„±í™”
    minutes: 30                # ğŸ“Š DATA: íŒ¨ë°° í‰ê·  9ë¶„ vs ìŠ¹ë¦¬ í‰ê·  124ë¶„ â†’ 30ë¶„ ê¶Œì¥

partial_exit:
  enabled: true                # ë¶€ë¶„ ì²­ì‚° í•µì‹¬ ì „ëµ âœ…
  tiers:
    # ğŸ“Š ML ê°œì„  (2025-12-15): ì†ìµë¹„ 0.38 â†’ ìµì ˆ íƒ€ê²Ÿ ìƒí–¥
    # ì´ë²ˆì£¼ ë¶„ì„: í‰ê·  ìŠ¹ë¦¬ +0.65% vs í‰ê·  ì†ì‹¤ -1.70% â†’ ë” ëŠ¦ê²Œ, ë” ì ê²Œ ì²­ì‚°
    - profit_pct: 1.5          # +1.5%ì— 30% ì²­ì‚° (ê¸°ì¡´ +0.7% 40% â†’ ìƒí–¥)
      exit_ratio: 0.3
    - profit_pct: 2.5          # +2.5%ì— 30% ì²­ì‚° (ê¸°ì¡´ +1.1% 40% â†’ ìƒí–¥)
      exit_ratio: 0.3
    # ë‚˜ë¨¸ì§€ 40%ëŠ” íŠ¸ë ˆì¼ë§ ìŠ¤í†±ìœ¼ë¡œ ì¶”ê°€ ìˆ˜ìµ ì¶”êµ¬ (ê¸°ì¡´ 20% â†’ 40%)

trailing_stop:
  activation_profit_pct: 2.5   # ğŸ“Š ML ê°œì„  (2025-12-16): 0.5 â†’ 2.5% (ë¶€ë¶„ì²­ì‚° í›„ í™œì„±í™”)
                               # ì´ìœ : ì¡°ê¸° í™œì„±í™”ë¡œ +1.5%, +2.5% ëª©í‘œ ë„ë‹¬ ì „ ì²­ì‚° ë°œìƒ
  distance_pct: 0.8            # ğŸ“Š DATA: ìµœê³ ê°€ ëŒ€ë¹„ -0.8% íŠ¸ë ˆì¼ë§ (íƒ€ì´íŠ¸í•˜ê²Œ)
  min_lock_profit_pct: 0.3     # ğŸ“Š DATA: ìµœì†Œ +0.3% ìˆ˜ìµ ë³´ì¥ (ì‘ì€ ìˆ˜ìµì´ë¼ë„ í™•ë³´)

vwap_exit:
  profit_threshold_for_ignore: 2.0  # +2.0% ì´ìƒì—ì„œëŠ” VWAP ë¬´ì‹œ
  multi_condition_required: true    # ë‹¤ì¤‘ ì¡°ê±´ í•„ìš” (VWAP ë‹¨ë… ì²­ì‚° ë°©ì§€)

# ========================================
# âœ… Squeeze Momentum ì „ëµ ì„¤ì • (LazyBear)
# ========================================
squeeze_momentum:
  enabled: true                      # ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ í™œì„±í™”

  # ì§„ì… ì¡°ê±´ ëª¨ë“œ ì„ íƒ
  # "squeeze_only"  : ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ë§Œ ì‚¬ìš© (ê¸°ì¡´ L0-L6 í•„í„° ë¬´ì‹œ)
  # "legacy_only"   : ê¸°ì¡´ í•„í„°ë§Œ ì‚¬ìš© (ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ ë¬´ì‹œ)
  # "hybrid"        : ë‘˜ ë‹¤ ì‚¬ìš© (ê¸°ì¡´ í•„í„° + ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€)
  entry_mode: "squeeze_only"         # âœ… ë‹´ì£¼ í…ŒìŠ¤íŠ¸: ìŠ¤í€´ì¦ˆ ëª¨ë©˜í…€ë§Œ ì‚¬ìš©

  # ì§„ì… í•„í„°
  entry_filter:
    enabled: true                    # ì§„ì… ì‹œ ìŠ¤í€´ì¦ˆ ì²´í¬ í™œì„±í™”
    require_bright_green: true       # Bright Green (ê°€ì†) í•„ìˆ˜
    min_momentum: 0.0                # ìµœì†Œ ëª¨ë©˜í…€ ê°’

  # ì²­ì‚° í•„í„°
  exit_filter:
    enabled: true                    # ì²­ì‚° ì‹œ ìŠ¤í€´ì¦ˆ ì²´í¬ í™œì„±í™”

    # Dark Green (ê°ì†) - ë¶€ë¶„ ìµì ˆ (íœ´ë¦¼ë¡œë´‡ ì„±ê³µ ì‚¬ë¡€)
    dark_green:
      enabled: true
      partial_exit_ratio: 0.3        # 30% ë¶€ë¶„ ìµì ˆ
      min_profit_pct: 1.0            # ìµœì†Œ ìˆ˜ìµë¥  1%

    # Red (ë°˜ì „) - ì „ëŸ‰ ì²­ì‚°
    red:
      enabled: true
      full_exit: true                # ì „ëŸ‰ ì²­ì‚°
      min_profit_pct: 0.5            # ìµœì†Œ ìˆ˜ìµë¥  0.5%

    # Bright Green (ê°€ì†) - ë³´ìœ  í•„ìˆ˜ (ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ êµí›ˆ)
    bright_green:
      force_hold: true               # ì ˆëŒ€ ë§¤ë„ ê¸ˆì§€
      ignore_trailing_stop: false    # íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ì€ ìœ ì§€ (ê³¼ë„í•œ ì†ì‹¤ ë°©ì§€)

  # ì§€í‘œ íŒŒë¼ë¯¸í„°
  parameters:
    bb_length: 20                    # Bollinger Bands ê¸°ê°„
    bb_mult: 2.0                     # Bollinger Bands ë°°ìˆ˜
    kc_length: 20                    # Keltner Channel ê¸°ê°„
    kc_mult: 1.5                     # Keltner Channel ë°°ìˆ˜
    mom_length: 20                   # ëª¨ë©˜í…€ ê³„ì‚° ê¸°ê°„

  # ì‹¤ì „ í†µê³„ (docs/1231 ë¶„ì„ ê¸°ë°˜)
  stats:
    tested_stocks: ["íœ´ë¦¼ë¡œë´‡", "ëª¨ë¹„ìŠ¤", "ì‚¼ë³´ëª¨í„°ìŠ¤", "ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ"]
    success_rate: 0.25               # ì‹ í˜¸ ì¼ì¹˜ìœ¨ 25% (1/4)
    best_case: "íœ´ë¦¼ë¡œë´‡"            # Dark Green ë¶€ë¶„ ìµì ˆ ì„±ê³µ
    worst_case: "ì•„ì´í‹°ì„¼ê¸€ë¡œë²Œ"     # Bright Green ì¡°ê¸° ìµì ˆë¡œ 8ë°° ìˆ˜ìµ ìƒì‹¤

time_based_exit:
  loss_breakeven_exit_time: "15:00:00"  # âš ï¸ EOD Managerë¡œ ëŒ€ì²´ ì˜ˆì • (Phase 1)
  final_force_exit_time: "15:05:00"     # âœ… ìˆ˜ì •: 15:05 (15:00â†’15:05, API ì§€ì—° ê³ ë ¤)
  loss_breakeven_threshold_pct: 0.0     # ì „ëŸ‰ ì²­ì‚°ìœ¼ë¡œ í†µì¼

# ========================================
# âœ… ChatGPT ë¦¬ë·° ë°˜ì˜: EOD ì •ì±… ì¶”ê°€
# ========================================
eod_policy:
  enabled: false                         # âŒ ë¹„í™œì„±í™”: ì‹œê°„ ê¸°ë°˜ ê°•ì œ ì²­ì‚° ì—†ìŒ
  check_time: "14:55:00"                 # âœ… ìˆ˜ì •: 14:55 (15:00ì—ì„œ ë³€ê²½, API ì§€ì—° ê³ ë ¤)
  force_exit_time: "15:05:00"            # âœ… ìˆ˜ì •: 15:05 (15:10ì—ì„œ ë³€ê²½)
  max_overnight_positions: 3             # ìµœëŒ€ ìµì¼ ë³´ìœ  ì¢…ëª© ìˆ˜
  min_overnight_score: 0.6               # ìµœì†Œ ë³´ìœ  ì ìˆ˜ (0.0-1.0)
  max_overnight_position_value_pct: 40  # âœ… ì¶”ê°€: ê³„ì¢Œ ìì‚°ì˜ 40%ê¹Œì§€ë§Œ ìµì¼ ë³´ìœ 

  # ìµì¼ ë³´ìœ  ê¸°ì¤€
  overnight_criteria:
    trend_weight: 0.4                    # ì¶”ì„¸ ê°€ì¤‘ì¹˜
    volume_weight: 0.3                   # ê±°ë˜ëŸ‰ ê°€ì¤‘ì¹˜
    news_weight: 0.3                     # ë‰´ìŠ¤/ì¬ë£Œ ê°€ì¤‘ì¹˜

    min_ema_state: true                  # EMA5 > EMA20 í•„ìˆ˜
    min_vol_z20: 1.0                     # ìµœì†Œ ê±°ë˜ëŸ‰ Z-score
    min_news_score: 50                   # ìµœì†Œ ë‰´ìŠ¤ ì ìˆ˜

  # âœ… ì¶”ê°€: ìš°ì„  ê°ì‹œ ë¦¬ìŠ¤íŠ¸ ì¡°ê±´ (ğŸ”¥ ChatGPT Fix: ì¡°ê±´ ê°•í™”)
  priority_watchlist:
    min_eod_score: 0.65                  # ìµœì†Œ EOD ì ìˆ˜ (0.55 â†’ 0.65)
    min_close_to_high_ratio: 0.88        # ì¢…ê°€/ê³ ê°€ ìµœì†Œ 88% (0.8 â†’ 0.88)
    min_vol_z20: 1.2                     # ìµœì†Œ ê±°ë˜ëŸ‰ Z-score (1.0 â†’ 1.2)
    min_news_score: 50                   # ìµœì†Œ ë‰´ìŠ¤ ì ìˆ˜ (45 â†’ 50, ì¤‘ë¦½ ì´ìƒ)

# ========================================
# âœ… ChatGPT ë¦¬ë·° ë°˜ì˜: ê°­ì—… ì¬ì§„ì… ì„¤ì •
# ========================================
gap_reentry:
  enabled: true
  gap_threshold_pct: 3.0                 # ê°­ì—… ê¸°ì¤€ (%)
  volume_z_threshold: 2.0                # ê±°ë˜ëŸ‰ Z-score ê¸°ì¤€
  check_window_minutes: 30               # ì²´í¬ ì‹œê°„ (ì¥ ì‹œì‘ í›„ 30ë¶„)
  reentry_confidence: 0.7                # ì¬ì§„ì… ì‹ ë¢°ë„
  first_candle_window: 5                 # âœ… ìˆ˜ì •: 3-5ë¶„ë´‰ ê¸°ì¤€ (1ë¶„ë´‰ì—ì„œ ì™„í™”)

logging:
  enabled: true
  log_dir: "logs"
  log_level: "INFO"

test:
  stock_symbols:
    - "005930"
    - "015760"
  data_days: 7
  interval: "5m"

# ========================================
# Bottom Pullback ì „ëµ ì„¤ì • (ì¡°ê±´ 23ë²ˆ)
# ========================================
condition_strategies:
  # ê¸°ì¡´ ëª¨ë©˜í…€ ì „ëµ (17-22ë²ˆ)
  momentum:
    condition_indices: [17, 18, 19, 20, 21, 22]
    strategy_tag: "momentum"
    immediate_entry: true
    description: "ê¸°ì¡´ ì¦‰ì‹œ ë§¤ìˆ˜ ì „ëµ (VWAP + L0-L6 í•„í„°)"

  # Bottom Pullback ì „ëµ (23ë²ˆ)
  bottom_pullback:
    condition_indices: [23]
    strategy_tag: "bottom_pullback"
    immediate_entry: false
    wait_for_pullback: true
    max_entries_per_day: 1
    description: "ì¡°ê±´ ì‹ í˜¸ â†’ VWAP Pullback ëŒ€ê¸° â†’ ì¬ëŒíŒŒ ì‹œ ì§„ì…"

    # Pullback ì¡°ê±´ ì •ì˜
    pullback:
      type: "vwap_reclaim"
      allow_below_vwap: true                    # VWAP ì´íƒˆ í—ˆìš©
      invalidate_if_break_signal_low: true      # ì‹ í˜¸ë´‰ ì €ê°€ ì´íƒˆ ì‹œ ë¬´íš¨í™”

      # âœ… VWAP ì´íƒˆ ì¡°ê±´ (ì •ëŸ‰í™”)
      break_conditions:
        vwap_break_threshold_pct: -0.3          # VWAP ëŒ€ë¹„ -0.3% ì´ìƒ ì´íƒˆ ì‹œ ê°ì§€
                                                # (ì‘ì€ ë…¸ì´ì¦ˆ ë¬´ì‹œ, ì˜ë¯¸ìˆëŠ” ì´íƒˆë§Œ ì¸ì •)

      # âœ… VWAP ì¬ëŒíŒŒ ì¡°ê±´ (ì •ëŸ‰í™”)
      reclaim_conditions:
        vwap_reclaim_threshold_pct: 0.2         # VWAP ëŒ€ë¹„ +0.2% ì´ìƒ ëŒíŒŒ ì‹œ ê°ì§€
                                                # (í™•ì‹¤í•œ ì¬ëŒíŒŒë§Œ ì¸ì •)
        min_volume_ratio: 1.0                   # ëŒíŒŒ ë´‰ ê±°ë˜ëŸ‰ â‰¥ ì§ì „ 5ë´‰ í‰ê· 
        confirm_candles: 1                       # ì¬ëŒíŒŒ í›„ í™•ì¸ ë´‰ ìˆ˜

      # ë¬´íš¨í™” ì¡°ê±´
      invalidation:
        break_signal_low_pct: -0.5              # ì‹ í˜¸ë´‰ ì €ê°€ -0.5% ì´íƒˆ ì‹œ ë¬´íš¨
        max_wait_minutes: 180                   # ê¸°ë³¸ ìµœëŒ€ ëŒ€ê¸° ì‹œê°„ 3ì‹œê°„

        # âœ… ë™ì  ì‹œê°„ ì œí•œ (ë³€ë™ì„± ê¸°ë°˜)
        use_dynamic_timeout: true               # ë™ì  ì‹œê°„ ì œí•œ í™œì„±í™”
        high_volatility_minutes: 120            # ê³ ë³€ë™ì„±: 2ì‹œê°„
        low_volatility_minutes: 240             # ì €ë³€ë™ì„±: 4ì‹œê°„
        volatility_threshold_high: 3.0          # ê³ ë³€ë™ì„± ê¸°ì¤€: ATR% >= 3.0
        volatility_threshold_low: 1.5           # ì €ë³€ë™ì„± ê¸°ì¤€: ATR% <= 1.5

      # ì‹œê°„ ì œí•œ
      time_window:
        start: "09:30"                          # ì§„ì… ê°€ëŠ¥ ì‹œì‘ ì‹œê°„
        end: "14:30"                            # ì§„ì… ê°€ëŠ¥ ì¢…ë£Œ ì‹œê°„
