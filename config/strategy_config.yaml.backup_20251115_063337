# VWAP 전략 설정 파일
# 모든 파라미터를 여기서 중앙 관리

# ========================================
# 트레일링 스탑 설정
# ========================================
trailing:
  activation_pct: 1.3        # 트레일링 활성화 수익률 (%) - 1.5 → 1.3 (조기 보호)
  ratio: 1.0                 # 트레일링 비율 (%)
  stop_loss_pct: 1.0         # 기본 손절 (%) - 1.3 → 1.0 (**긴급 수정: -10% 손실 재발 방지**)
  emergency_stop_pct: 2.0    # 긴급 손절 (%) - **신규 추가: API 오류/급락 대비 최종 방어선**

  # 목표가 도달 후 강화된 트레일링
  use_profit_tier: false     # 목표가 도달 후 강화 여부
  profit_tier_threshold: 3.0 # 강화 트레일링 시작 수익률 (%)
  profit_tier_ratio: 0.5     # 강화 트레일링 비율 (%)

  # ATR 기반 트레일링
  use_atr_based: false       # ATR 기반 트레일링 사용 여부
  atr_multiplier: 1.5        # ATR 배수


# ========================================
# VWAP 설정
# ========================================
vwap:
  use_rolling: true          # true = 이동 VWAP, false = 누적 VWAP
  rolling_window: 20         # 이동 VWAP 윈도우 (봉 개수, 5분봉 기준 20봉 = 100분)


# ========================================
# 필터 설정
# ========================================
filters:
  # 추세 필터
  use_trend_filter: true     # MA 기반 추세 필터
  trend_period: 20           # 추세 판단 기간 (봉)

  # 거래량 필터
  use_volume_filter: true    # 거래량 급증 필터
  volume_multiplier: 1.3     # 평균 대비 배수 (1.1 → 1.3, 거래량 급증 필수)

  # Williams %R 필터 (과매수 진입 억제)
  use_williams_r_filter: true   # Williams %R 필터 사용 여부
  williams_r_period: 14         # Williams %R 계산 기간 (기본 14)
  williams_r_long_ceiling: -30  # 롱 진입 시 %R 상한 (-20 → -30, 과매수 진입 더 엄격하게)
  williams_r_short_floor: -80   # 숏 진입 시 %R 하한 (미사용, 향후 확장용)

  # VWAP 돌파 지속성 확인
  use_breakout_confirm: true   # 돌파 지속성 확인 (Williams %R과 함께 사용 권장)
  breakout_confirm_candles: 1  # 확인 캔들 수 (1봉 = 현재봉 확정만)

  # 거래대금 필터
  use_volume_value_filter: false  # 거래대금 절대값 필터
  min_volume_value: 1000000000    # 최소 거래대금 (10억원)

  # 시장 모멘텀 필터
  use_market_momentum: false      # 시장 모멘텀 필터 (개별 종목 초기 돌파 방해하므로 OFF 권장)

  # 진입 조건 완화 옵션 (현실화)
  vwap_tolerance_pct: 0.3         # VWAP 허용 오차 (%) - 0.0 → 0.3 (VWAP -0.3% 이내 근접 허용)
  ma_tolerance_pct: 0.2           # MA20 허용 오차 (%) - 0.0 → 0.2 (MA20 -0.2% 이내 근접 허용)
  vwap_cross_only: false          # true → false (상향 돌파 + 근접 허용 병행, 기회 손실 축소)

  # 일봉 추세 강도 필터
  use_daily_trend_filter: false   # 일봉 추세 강도 필터
  use_ema_alignment: true         # EMA 정배열 체크
  use_rsi_filter: true            # RSI 필터
  rsi_threshold: 50.0             # RSI 최소값

  # 변동성 필터
  use_volatility_filter: false    # 변동성 필터
  min_atr_pct: 0.5                # 최소 ATR (%)
  max_atr_pct: 5.0                # 최대 ATR (%)


# ========================================
# 시간 필터
# ========================================
time_filter:
  use_time_filter: false     # 시간 필터 사용 여부
  market_open: "09:00"       # 장 시작 시간
  market_close: "15:20"      # 장 마감 시간
  avoid_early_minutes: 10    # 장 시작 후 회피 시간 (분)
  avoid_late_minutes: 10     # 장 마감 전 회피 시간 (분)


# ========================================
# 재진입 방지
# ========================================
re_entry:
  use_cooldown: false        # 재진입 대기 사용 여부
  cooldown_minutes: 30       # 재진입 대기 시간 (분)


# ========================================
# 리스크 관리
# ========================================
risk_management:
  initial_capital: 10000000      # 초기 자본금 (1천만원)
  daily_max_loss_pct: 2.0        # 일일 최대 손실 (%)
  max_drawdown_pct: 10.0         # 최대 낙폭 (%)
  max_trades_per_day: 5          # 일일 최대 거래 횟수
  max_consecutive_losses: 3      # 최대 연속 손실 횟수
  position_risk_pct: 1.0         # 거래당 리스크 (%)
  min_rr_ratio: 1.5              # 최소 손익비


# ========================================
# 부분 청산 설정 (PF 개선 목적)
# ========================================
partial_exit:
  enabled: true              # 부분 청산 사용 - false → true (활성화)
  tiers:
    - profit_pct: 1.0        # 첫 목표: +1.0% (1.5 → 1.0, 빠른 이익 실현)
      exit_ratio: 0.3        # 30% 청산 (50 → 30, 완화)
    - profit_pct: 2.0        # 두 번째 목표: +2.0% (3.0 → 2.0)
      exit_ratio: 0.3        # 30% 청산 (총 60% 청산)
    # 나머지 40%는 트레일링 스탑으로 큰 수익 기대


# ========================================
# 로깅 설정
# ========================================
logging:
  enabled: true              # 로깅 사용 여부
  log_dir: "logs"            # 로그 저장 디렉토리
  log_level: "INFO"          # 로그 레벨 (DEBUG, INFO, WARNING, ERROR)


# ========================================
# 테스트 설정
# ========================================
test:
  stock_symbols:
    - "005930"  # 삼성전자
    - "015760"  # 한국전력

  data_days: 7               # 테스트 데이터 기간 (일)
  interval: "5m"             # 데이터 간격
