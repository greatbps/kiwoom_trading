# 2025-11-28 거래 분석 보고서

## 📊 일일 실적 요약

- **총 거래**: 14건 (매수 7, 매도 7)
- **일일 실현손익**: **+5,250원** ✅
- **승률**: 75% (6승 2패)
- **초기 잔고**: 389,354원
- **주간 누적 손익**: -12,874원

## 🏆 Best Trade
**코오롱티슈진 (950160)**: 82,600원 → 85,700원 = **+3,100원** (3.75% 수익)

## 📉 Worst Trade
**한올바이오파마 (009420)**: 45,750원 → 45,450원 = **-600원** (Early Failure Cut, 4분 보유)

## 📈 Signal Orchestrator 통계

### 필터 성능
- 총 평가: 2,577회
- ACCEPT: 1,690회 (65.6%)
- REJECT: 887회 (34.4%)

### 차단 사유
1. **CONFIDENCE 부족**: 490건 (55.2%)
2. **L0 (시간/손실한도)**: 397건 (44.8%)

### 가장 많이 통과한 종목
1. 476060 온코닉테라퓨틱스: 559회 → 매수 1건, +300원 ✅
2. 009420 한올바이오파마: 390회 → 매수 2건, -600원/+700원
3. 014280 금강공업: 172회 → 매수 0건 (CONFIDENCE 차단)

## 🚨 발견된 문제점

### 1. 중복 프로세스 이중 매수 (CRITICAL)
**증상:**
- 009420 한올바이오파마 1주 매수 기록
- 실제로는 2주 매도 → 중복 프로세스가 각각 1주씩 매수

**원인:**
- 10:57 백그라운드 프로세스 (PID 151120)
- 11:30 사용자가 터미널에서 `./run.sh` 재실행 (PID 151781)
- 두 프로세스가 동시에 같은 종목 매수

**영향:**
- -600원 손실 (의도하지 않은 2주 포지션 → Early Failure Cut)

**해결 필요:**
- 프로세스 중복 실행 방지 (PID lock file)
- 실행 전 기존 프로세스 자동 종료

### 2. 쿨다운 로직 불일치
**증상:**
- 로그: "연속 손실 쿨다운 중 (해제: 2025-11-29)" 558회
- 실제: risk_log.json에는 `cooldown_until: None`
- 결과: 쿨다운 메시지 이후에도 거래 계속 진행

**타임라인:**
- 11:01 - 009420 Early Failure Cut (-600원)
- 11:03 - 쿨다운 메시지 558회 발생
- 12:35 - 정상 거래 재개 (476060, 448900 매수)

**추정 원인:**
- 중복 프로세스 중 하나가 쿨다운 진입
- 다른 프로세스는 쿨다운 없이 거래
- 또는 risk_log.json 초기화/리셋

**해결 필요:**
- 쿨다운 상태 파일 기반 공유
- 프로세스 간 동기화 메커니즘

### 3. CONFIDENCE 차단 비율 높음 (55%)
**현황:**
- 490건이 MIN_CONFIDENCE (0.4) 미달로 차단
- 실제 거래 가능 종목 수 제한

**개선 고려사항:**
- MIN_CONFIDENCE 0.4 → 0.35 추가 완화?
- 또는 현재 75% 승률 유지를 위해 현상 유지

## ✅ 잘 작동한 부분

### 1. Early Failure Cut
- 009420: 4분 만에 -0.66% 손실 감지 → 즉시 청산 ✅
- 큰 손실 방지 효과

### 2. 재진입 로직
- 009420: 손실 후 재진입 → +700원 수익 회복 ✅
- 318060: 손실 후 재진입 시도 (추가 -150원이지만 시스템 작동)

### 3. 수익 확정
- 코오롱티슈진: +3.75% → 적시 매도 ✅
- 한국피아이엠: +1.28% → 적시 매도 ✅

### 4. 필터 시스템
- L0-L6 필터가 위험 종목 차단
- 014280 금강공업: 172회 평가되었지만 CONFIDENCE 부족으로 차단 (과도한 매수 방지)

## 📌 프로그램 반영 권장사항

### Priority 1 (즉시 적용)
1. **중복 프로세스 방지**
   - PID lock file 구현
   - 기존 프로세스 존재 시 에러 또는 자동 종료

### Priority 2 (단기 개선)
2. **쿨다운 상태 파일 기반 관리**
   - risk_log.json 외에 별도 cooldown.lock 파일
   - 프로세스 간 공유 가능한 쿨다운 상태

3. **로깅 개선**
   - 모든 거래에 process_id 기록
   - 어느 프로세스가 어떤 거래했는지 추적

### Priority 3 (중장기 검토)
4. **MIN_CONFIDENCE 조정 검토**
   - 현재: 0.4 (490건 차단)
   - 75% 승률 유지하면서 거래 기회 확대 가능성 검토

5. **Early Failure Cut 시간 조정**
   - 현재: 4분 내 손실 시 즉시 청산
   - 효과적이지만 너무 빠른지 검토 (5-10분으로 연장?)

## 📊 종합 평가

### ✅ 성과
- **일일 수익**: +5,250원 (1.35% ROI)
- **높은 승률**: 75%
- **리스크 관리**: Early Failure Cut 작동
- **재진입**: 손실 후 재진입으로 수익 회복

### ⚠️ 개선 필요
- 중복 프로세스 방지
- 쿨다운 로직 동기화
- CONFIDENCE 차단 비율 모니터링

### 📈 시스템 안정성
- 필터 시스템: 정상 작동 ✅
- 매수/매도 실행: 정상 작동 ✅
- 손절 로직: 정상 작동 ✅
- 다중 프로세스 이슈: 개선 필요 ⚠️

---

**생성 일시**: 2025-11-28
**분석 대상**: 14건 거래 (10:57 ~ 13:31)
**최종 평가**: ✅ 수익 달성, 시스템 안정적, 프로세스 관리 개선 필요
